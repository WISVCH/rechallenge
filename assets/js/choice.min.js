var CHoice;!function(e){CHoice={init:function(e){CHoice.url=window.choice_url,CHoice.settings={blueprintItem:"<li class='accordion-item' data-accordion-item><a href='#' class='accordion-title clearfix'>{% courseName %}</a><div class='accordion-content' data-tab-content style='display: none;'><h4>Exams/Summaries</h4><table cellspacing='0'><thead><tr><th width='150px'>Course Code</th><th>Exam</th><th width='150px'>Answers</th><th width='50px'></th></tr></thead><tbody>{% content %}</tbody></table></li>",blueprintItemNoResult:"<li class='accordion-item' data-accordion-item><a href='#' class='accordion-title clearfix'>No courses found that match your search criteria.</li>",blueprintRow:"<tr><td>{% courseCode %}</td><td>{% name %}</td><td><span class='ch-{% answers %}'></span></td><td><a target='_blank' href='"+CHoice.url+"document/exam/{% documentId %}' class='button tiny'><span class='ch-file-o'></span></a></td></tr>",blueprintRowNoResult:"<tr><td colspan='4'>No exams available yet.</td></tr>"},CHoice.initChoice(),CHoice.binds()},binds:function(){e("#searchQuery").on("keyup",function(){setTimeout(function(){CHoice.searchCourses()},300)}),e("#searchStudy, #searchProgram").on("change",function(){CHoice.searchCourses()})},initChoice:function(){e.ajax({url:CHoice.url+"course/active",async:!1,dataType:"json",success:function(e){CHoice.handleGetCourses(e)}})},searchCourses:function(){e.ajax({url:CHoice.url+"course/active/search",data:{study:e("#searchStudy").val(),program:e("#searchProgram").val(),query:e("#searchQuery").val()},async:!1,dataType:"json",success:function(e){CHoice.handleGetCourses(e)}})},handleGetCourses:function(t){e("#choice-accordion").empty(),t.content.length>0?e.each(t.content,function(t,o){var c=o.code+" "+o.name,n=CHoice.settings.blueprintItem.split("{% courseName %}").join(c),a=CHoice.handleGetCourseExamResponse(o.exam);n=n.split("{% content %}").join(a),e("#choice-accordion").append(n)}):e("#choice-accordion").append(CHoice.settings.blueprintItemNoResult),Foundation.reInit(e("#choice-accordion"))},handleGetCourseExamResponse:function(t){var o="";return t.length>0?e.each(t,function(e,t){var c=CHoice.settings.blueprintRow.split("{% courseCode %}").join(t.course.code),n=t.date.month.toLowerCase().replace(/\b[a-z]/g,function(e){return e.toUpperCase()}),a=t.name+" "+n+" "+t.date.dayOfMonth+", "+t.date.year;c=(c=(c=c.split("{% name %}").join(a)).split("{% documentId %}").join(t.id)).split("{% answers %}").join(t.includingAnswers?"check":"ban"),o+=c}):o=CHoice.settings.blueprintRowNoResult,o}}}(jQuery);